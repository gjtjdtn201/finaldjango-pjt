{% extends 'base.html' %}

{% block content %}

<h1 class='mt-5 text-info'>{{ user.username }}</h1>

{% for gen in genre %}
{% if gen in request.user.like_gens.all %}
  <button class="btn btn-danger my-1" data-pk="{{ gen.pk }}" >{{ gen.name }}</button>
{% else %}
  <button class="btn btn-secondary my-1" data-pk="{{ gen.pk }}">{{ gen.name }}</button>
{% endif %}
{% endfor %}

<script>
    const genBtns = document.querySelectorAll('.btn')
    genBtns.forEach(function(btn){
      btn.addEventListener('click', function(event){
        console.log(event.target.dataset.pk)
        const genId = event.target.dataset.pk
        axios.get(`/accounts/${genId}/genlike/`)
        .then(function(res){
          console.log(res.data)
          if (res.data.liked){
            btn.classList.remove('btn-secondary')
            btn.classList.add('btn-danger')
          } else {
              btn.classList.remove('btn-danger')
              btn.classList.add('btn-secondary')
            }
        })
        .catch(function(err){
          console.log(err)
        })
      })
    })
</script>

{% endblock %}
